import{_ as B,r as N,a as b,c as S,b as y,d as l,e as u,w as r,f as z,v as P,g as k,h as o,n as E,E as L,i as q,j as F,k as j,l as I,o as f,m as n,T as A,F as G,p as Q,t as w,q as $,s as U,u as J,x as K}from"./index-xs5ZEPJD.js";const O={class:"tw-max-w-[600px] tw-pb-20"},W={class:"tw-mb-4 tw-flex tw-gap-x-4"},X={key:0,class:"tw-bg-gray-200 tw-py-20 tw-text-center"},Z={key:1,class:"tw-border tw-border-gray-200 tw-py-6"},ee={class:"tw-px-6"},te={class:"tw-flex tw-flex-col tw-gap-y-2"},se={class:""},oe={class:""},ae={class:""},ne=["innerHTML"],le={class:"tw-absolute tw-right-0 tw-top-0"},re={class:"tw-text-2xl"},ie={class:"tw-text-2xl"},de={__name:"Dashboard",setup(me){const M=N({dateTimeRange:["",""]}),Y=b(!1),c=b([]),C=S(()=>c.value.reduce((s,e)=>e.price?s+e.price:s,0)),R=(s,e)=>{const i=o(e).diff(o(s),"minute"),p=Math.floor(i/60),d=i%60;let a=p*20;return d>0&&(a+=d<=30?10:20),{hours:p,minutes:d,price:Math.min(a,200)}},v=s=>`${Number(s).toFixed(0).replace(/./g,(i,p,d)=>p&&i!=="."&&(d.length-p)%3===0?`, ${i}`.replace(/\s/g,""):i)}`,H=(s=1e3)=>new Promise(e=>{setTimeout(e,s)}),V=async()=>{Y.value=!0,c.value=[];const[s,e]=M.dateTimeRange;if(!s||!e){Y.value=!1;return}const i=o(s).format("YYYY-MM-DD"),p=o(e).format("YYYY-MM-DD"),d=o(p).diff(o(i),"day");for(let a=0;a<=d;a++){const _=a===0?o(s).add(a,"day").format("YYYY-MM-DD HH:mm"):o(s).add(a,"day").format("YYYY-MM-DD 00:00"),g=o(_).add(1,"day").format("YYYY-MM-DD 00:00"),D=o(g).isAfter(e)?o(e).format("YYYY-MM-DD HH:mm"):o(g).format("YYYY-MM-DD HH:mm"),{hours:m,minutes:t,price:x}=R(_,D);if(m===0&&t===0)continue;let T=`${m} * 20 = ${m*20} 元`;t>0&&(t<=30?T=`${m} * 20 + 1 * 10 (未滿半小時，以半小時計) = ${m*20+1*10} 元`:T=`${m} * 20 + 1 * 20 (超過半小時，且未滿1小時，以1小時計) = ${m*20+1*20} 元`),await H(600),c.value.push({type:"primary",size:"large",timestamp:o(_).format("YYYY-MM-DD HH:mm"),dateRange:`${_} ～ ${D}`,price:x,hours:m,minutes:t,priceCalcProcess:T}),await E(),h()}await H(600),c.value.push({type:"primary",size:"large",timestamp:o(e).format("YYYY-MM-DD HH:mm")}),await E(),h(),Y.value=!1},h=()=>{document.querySelector(".el-main").scrollTo({top:document.querySelector(".el-main").scrollHeight,behavior:"smooth"})};return(s,e)=>{const i=L,p=q,d=F,a=U,_=J,g=K,D=j,m=I;return f(),y("div",O,[l("div",W,[u(i,{modelValue:M.dateTimeRange,"onUpdate:modelValue":e[0]||(e[0]=t=>M.dateTimeRange=t),type:"datetimerange","start-placeholder":"起始日期","end-placeholder":"結束日期",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:00","unlink-panels":""},null,8,["modelValue"]),u(p,{type:"primary",onClick:V},{default:r(()=>e[1]||(e[1]=[n("查詢")])),_:1})]),c.value.length<=0&&!Y.value?(f(),y("div",X,[u(d,{type:"danger",class:"!tw-text-lg"},{default:r(()=>e[2]||(e[2]=[n(" 請先選擇起迄時間 ")])),_:1})])):c.value.length>0?(f(),y("div",Z,[l("div",ee,[u(D,null,{default:r(()=>[u(A,{name:"fade"},{default:r(()=>[(f(!0),y(G,null,Q(c.value,(t,x)=>(f(),$(g,{key:x,placement:"top",icon:t.icon,type:t.type,color:t.color,size:t.size,hollow:t.hollow,timestamp:t.timestamp},{default:r(()=>[t.dateRange?(f(),$(_,{key:0},{default:r(()=>[l("div",te,[l("p",se,w(t.dateRange),1),l("p",oe,[e[3]||(e[3]=n(" 共 ")),u(a,{type:"primary"},{default:r(()=>[n(w(t.hours),1)]),_:2},1024),e[4]||(e[4]=n(" 小時 ")),u(a,{type:"primary"},{default:r(()=>[n(w(t.minutes),1)]),_:2},1024),e[5]||(e[5]=n(" 分 "))]),l("p",ae,[e[6]||(e[6]=n(" 金額為:")),e[7]||(e[7]=l("br",null,null,-1)),l("span",{class:"tw-block tw-pl-4",innerHTML:t.priceCalcProcess},null,8,ne)]),l("p",le,[e[8]||(e[8]=n(" 小計 $ ")),u(a,{type:"danger"},{default:r(()=>[n(w(v(t.price)),1)]),_:2},1024),e[9]||(e[9]=n(" 元 "))])])]),_:2},1024)):k("",!0)]),_:2},1032,["icon","type","color","size","hollow","timestamp"]))),128))]),_:1})]),_:1})]),z(u(m,null,{default:r(()=>[l("p",re,[e[10]||(e[10]=n(" 總計 $ ")),u(d,{type:"danger"},{default:r(()=>[l("span",ie,w(v(C.value)),1)]),_:1}),e[11]||(e[11]=n(" 元 "))])]),_:1},512),[[P,!Y.value]])])):k("",!0)])}}},pe=B(de,[["__scopeId","data-v-912d8b47"]]);export{pe as default};
